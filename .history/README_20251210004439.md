# Xablau Monitoring

Sistema de monitoramento e contagem de pÃ¡ginas PDF com envio automÃ¡tico de relatÃ³rios via WhatsApp.

## ğŸ“‹ DescriÃ§Ã£o

Este projeto consiste em um sistema completo para monitorar pastas contendo arquivos PDF, contar o nÃºmero de pÃ¡ginas em cada pasta e enviar relatÃ³rios automÃ¡ticos via WhatsApp. O sistema oferece duas modalidades de operaÃ§Ã£o:

- **ExecuÃ§Ã£o manual**: Contagem Ãºnica de pÃ¡ginas PDF em pastas especÃ­ficas
- **Monitoramento contÃ­nuo**: Monitoramento automÃ¡tico de uma pasta com detecÃ§Ã£o de mudanÃ§as em tempo real

## ğŸš€ Funcionalidades

- âœ… Contagem de pÃ¡ginas PDF em mÃºltiplas pastas
- âœ… Processamento paralelo para melhor performance
- âœ… Monitoramento automÃ¡tico de pastas com detecÃ§Ã£o de mudanÃ§as
- âœ… Envio automÃ¡tico de relatÃ³rios via WhatsApp (grupos ou contatos individuais)
- âœ… HistÃ³rico de contagens com persistÃªncia em JSON
- âœ… Debounce inteligente para evitar execuÃ§Ãµes desnecessÃ¡rias
- âœ… Suporte multiplataforma (Windows, Linux, macOS)

## ğŸ“ Estrutura do Projeto

```
XABLAU PROJECT/
â”œâ”€â”€ pagecounter-folders.py    # Script principal de contagem de pÃ¡ginas
â”œâ”€â”€ folder-monitor.py         # Monitor de pastas com detecÃ§Ã£o de mudanÃ§as
â”œâ”€â”€ whatsapp-sender.js        # Servidor Node.js para envio via WhatsApp
â”œâ”€â”€ config.json               # Arquivo de configuraÃ§Ã£o
â”œâ”€â”€ pagecount_history.json    # HistÃ³rico de contagens
â”œâ”€â”€ requirements.txt          # DependÃªncias Python
â”œâ”€â”€ package.json              # DependÃªncias Node.js
â””â”€â”€ README.md                 # Este arquivo
```

## ğŸ“¦ PrÃ©-requisitos

1. **Python 3.x** (recomendado 3.8 ou superior)
2. **Node.js** (versÃ£o 14 ou superior)
3. **npm** (geralmente vem com Node.js)

## ğŸ”§ InstalaÃ§Ã£o

1. Clone o repositÃ³rio:

   ```bash
   git clone https://github.com/thalesv6/Xablau-Monitoring.git
   cd Xablau-Monitoring
   ```

2. Instale as dependÃªncias Python:

   ```bash
   pip install -r requirements.txt
   ```

3. Instale as dependÃªncias Node.js:

   ```bash
   npm install
   ```

## âš™ï¸ ConfiguraÃ§Ã£o

Edite o arquivo `config.json` para configurar o sistema:

```json
{
  "whatsapp": {
    "type": "group",
    "target": "Nome do Grupo ou NÃºmero",
    "enabled": true
  },
  "message": {
    "timeout": 30000,
    "min_cooldown_seconds": 60
  },
  "monitor": {
    "delay_seconds": 120,
    "watch_path": "C:/caminho/para/pasta/",
    "enabled": true
  }
}
```

### ConfiguraÃ§Ã£o do WhatsApp

- **Para enviar para um grupo**:

  - `"type": "group"`
  - `"target": "Nome Exato do Grupo"` (o nome como aparece no WhatsApp)

- **Para enviar para um contato individual**:

  - `"type": "number"`
  - `"target": "5511999999999"` (cÃ³digo do paÃ­s + nÃºmero, sem espaÃ§os ou caracteres especiais)

- **Para desabilitar o envio WhatsApp**:
  - `"enabled": false`

### ConfiguraÃ§Ã£o do Monitor

- `delay_seconds`: Tempo de espera (em segundos) apÃ³s detectar mudanÃ§as antes de executar a contagem
- `watch_path`: Caminho da pasta a ser monitorada
- `enabled`: Ativa/desativa o monitoramento automÃ¡tico

### ConfiguraÃ§Ã£o de Mensagens

- `timeout`: Timeout em milissegundos para envio de mensagens
- `min_cooldown_seconds`: Tempo mÃ­nimo entre envios de mensagens

## ğŸ¯ Uso

### ExecuÃ§Ã£o Manual

Execute o script de contagem diretamente:

```bash
python pagecounter-folders.py
```

O script irÃ¡:

1. Contar todas as pÃ¡ginas PDF em cada pasta
2. Exibir os resultados no terminal
3. Enviar automaticamente os resultados para o WhatsApp configurado (se habilitado)

### Monitoramento AutomÃ¡tico

Para monitorar uma pasta automaticamente:

```bash
python folder-monitor.py
```

O monitor irÃ¡:

1. Observar a pasta configurada em `config.json`
2. Detectar mudanÃ§as em arquivos PDF
3. Aguardar o perÃ­odo de debounce configurado
4. Executar automaticamente a contagem de pÃ¡ginas
5. Enviar os resultados via WhatsApp

## ğŸ” Primeira ExecuÃ§Ã£o (WhatsApp)

Na primeira vez que executar, serÃ¡ necessÃ¡rio autenticar com o WhatsApp Web:

1. Execute o script Python normalmente
2. Um QR Code aparecerÃ¡ no terminal
3. Abra o WhatsApp no celular
4. VÃ¡ em **ConfiguraÃ§Ãµes > Aparelhos conectados > Conectar um aparelho**
5. Escaneie o QR Code exibido no terminal
6. A sessÃ£o serÃ¡ salva automaticamente na pasta `.wwebjs_auth/` para prÃ³ximas execuÃ§Ãµes

## ğŸ“ Notas Importantes

- A primeira execuÃ§Ã£o pode demorar mais devido Ã  autenticaÃ§Ã£o WhatsApp
- A sessÃ£o do WhatsApp Ã© salva na pasta `.wwebjs_auth/` (nÃ£o commitada no git)
- Se o grupo nÃ£o for encontrado, o script listarÃ¡ os grupos disponÃ­veis
- O histÃ³rico de contagens Ã© salvo em `pagecount_history.json`
- O monitor usa debounce para evitar mÃºltiplas execuÃ§Ãµes quando vÃ¡rios arquivos sÃ£o modificados simultaneamente

## ğŸ› ï¸ Tecnologias Utilizadas

- **Python**: Processamento e contagem de PDFs
- **PyPDF2**: Biblioteca para leitura de arquivos PDF
- **watchdog**: Monitoramento de sistema de arquivos
- **Node.js**: Servidor para integraÃ§Ã£o com WhatsApp
- **whatsapp-web.js**: Cliente WhatsApp Web para Node.js

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a ISC.

## ğŸ”— RepositÃ³rio

[GitHub - Xablau Monitoring](https://github.com/thalesv6/Xablau-Monitoring)
